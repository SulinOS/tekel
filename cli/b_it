#!/bin/bash
PATH=$PATH:/usr/libexec/tekel/api
script_url=$(get_script_url $2)
rm -rf "/data/app/$USER/$2"
mkdir -p "/data/app/$USER/$2"
if [ "$script_url" == "" ] ; then
    echo "package not found in repo"
    rm -rf "/data/app/$USER/$2"
    exit 1
fi
curl $script_url > /data/app/$USER/$2/$2.tekel
cd /data/app/$USER/$2
for i in $SRCS
do
	wget -c $i
done
cd /data/app/$USER/$2
. $2.tekel
cd /data/app/$USER/$2
_setup || true
cd /data/app/$USER/$2
_build || true
cd /data/app/$USER/$2
_install || true
cd /data/app/$USER/$2

export dfile="$HOME/.local/share/applications/$NAME.desktop"
touch $dfile
chmod +x $dfile
echo "[Desktop Entry]" > $dfile
echo "Version=1.0" >> $dfile
echo "Name=$NAME" >> $dfile
echo "Comment=$COMMENT" >> $dfile
echo "Categories=$CATEGORY" >> $dfile
echo "Icon=$ICON" >> $dfile
echo "Exec=$EXEC" >> $dfile
echo "Type=Application" >> $dfile
echo "MimeType=$MIMETYPE" >> $dfile
echo "X-GNOME-UsesNotifications=true" >> $dfile
